@model IEnvironmentCrimeRepository

@{
    Layout = "_CoordinatorLayout";
}
@* TO DO --> 
    Vi börjar med samordnaren som ska kunna välja vilken avdelning som ska ha ansvar för ärendet.
    Observera att den enda avdelningen som inte ska väljas är Småstads Kommun då den är en
    övergripande enhet och inte har någon chef eller handläggaren knuten till sig. Endast
    samordnaren är kopplad till den avdelningen.
    När samordnaren valt avdelning och väljer att spara så ska ärendet uppdateras med avdelningsid,
    vilket ska synas på både sidan där tabellen med ärenden finns och på ärendets detaljsida.
    Du väljer själv om man ska vara kvar på detaljsidan när man tryckt spara eller om man hamnar på
    startsidan där alla ärenden syns.
    Tänk på att om man trycker på spara när ingen avdelning är vald så ska inget hända < -- TO DO
    *@
<h2>Ärenden</h2>
<p class="info">Du är inloggad som samordnare</p>

<table id="managerForm">
    <tr>
        <td class="label">Välj status:</td>
        <td class="label">Välj avdelning:</td>
        <td>&nbsp;</td>
        <td class="label">Ärendenummer:</td>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td>
            <select name="status">
                <option selected="selected">Välj alla</option>
                @foreach (ErrandStatus errandStatus in Model.ErrandStatuses)
                {
                    <option>@errandStatus.StatusName</option>
                }
            </select>
        </td>
        <td>

            <select name="department">
                <option selected="selected">Välj alla</option>
                @foreach (Department department in Model.Departments)
                {
                    <option value="@department.DepartmentId">@department.DepartmentName</option>
                }
            </select>
        </td>
        <td>
            <input class="button" type="submit" value="Hämta lista" />
        </td>
        <td>
            <input name="casenumber" />
        </td>
        <td>
            <input class="button" type="submit" value="Sök" />
        </td>
    </tr>
</table>

<!--Nedan ser man en lista på ärenden-->
<table>
    <tr>
        <th>Ärende anmält</th>
        <th>Ärendenummer</th>
        <th>Miljöbrott</th>
        <th>Status</th>
        <th>Avdelning</th>
        <th>Handläggare</th>
    </tr>
    @foreach (Errand errand in Model.Errands)
    {
        <tr>
            <td>@errand.DateOfObservation.ToShortDateString()</td> @* Har tagit bort ToString() *@
            <td>
                <a asp-controller="Coordinator" asp-action="CrimeCoordinator" asp-route-id="@errand.ErrandID">@errand.RefNumber</a>
            </td>
            <td>@errand.TypeOfCrime</td>
            <td>@errand.StatusId</td>
            <td>@errand.DepartmentId</td>
            <td>@errand.EmployeeId</td>
        </tr>
    }
</table>
